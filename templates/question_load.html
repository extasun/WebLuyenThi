{% load static %}

<!-- Add MathJax support -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>

{% if noi_dung_de.cau_hoi.loai_cau_hoi == 'TN' %}
<div id="question-{{ noi_dung_de.thu_tu_cau }}" data-tab="{{ noi_dung_de.thu_tu_cau }}" class="question-container max-w-full flex-1 mb-4">
    <div class="flex flex-col items-start">
        <span class="font-bold ml-2 text-2xl">{{ noi_dung_de.cau_hoi.tieu_de }}</span>
        <div class="flex flex-grow">
            <span class="bg-gray-200 rounded-full text-center inline-flex items-center justify-center w-10 h-10 font-bold mr-4 flex-shrink-0">
                {{ noi_dung_de.thu_tu_cau }}
            </span>
            <p class="text-xl mb-4 latex-content">
                {{ noi_dung_de.cau_hoi.noi_dung|safe }}
            </p>
        </div>
        <div class="flex-grow">
            <div class="flex flex-col space-y-2 ml-12">
                {% for dap_an in dapans %}
                <label class="inline-flex items-center">
                    <input type="radio" id="radio{{ noi_dung_de.thu_tu_cau }}-{{ dap_an.id }}" name="answer_{{ noi_dung_de.thu_tu_cau }}" value="{{ dap_an.id }}" class="hidden peer" />
                    <span class="w-6 h-6 flex-shrink-0 flex items-center justify-center rounded-full border peer-checked:bg-blue-700 peer-checked:border-blue-700 bg-gray-300 border-gray-300"></span>
                    <span class="ml-2 text-lg latex-content">
                        {{ dap_an.noi_dung|safe }}
                    </span>
                </label>
                {% endfor %}
            </div>
        </div>
    </div>
    {% if noi_dung_de.cau_hoi.anh %}
    <div class="mt-4">
        <img src="{{ noi_dung_de.cau_hoi.anh.url }}" alt="Image" class="max-w-full h-auto" />
    </div>
    {% endif %}
</div>
{% elif noi_dung_de.cau_hoi.loai_cau_hoi == 'CB' %}
<div id="question-{{ noi_dung_de.thu_tu_cau }}" data-tab="{{ noi_dung_de.thu_tu_cau }}" class="question-container max-w-full flex-1 mb-4">
    <div class="flex flex-col items-start">
        <div class="flex items-center mb-2">
            <span class="bg-gray-200 rounded-full text-center inline-flex items-center justify-center w-8 h-8 font-bold mr-4 flex-shrink-0">
                {{ noi_dung_de.thu_tu_cau }}
            </span>
            <p class="text-lg latex-content">
                {{ noi_dung_de.cau_hoi.noi_dung|safe }}
            </p>
        </div>
        <div class="flex-grow ml-12">
            <div class="flex justify-end space-x-8 mb-2">
                <span class="font-bold">Đúng</span>
                <span class="font-bold">Sai</span>
            </div>
            {% for dap_an in dapans %}
            <div class="flex items-center justify-between mt-2">
                <span class="text-lg flex-grow latex-content">
                    {{ dap_an.noi_dung|safe }}
                </span>
                <div class="flex items-center space-x-8 ml-16">
                    <label class="inline-flex items-center">
                        <input type="radio" id="radio{{ noi_dung_de.thu_tu_cau }}-{{ dap_an.id }}-dung" name="answer_{{ noi_dung_de.thu_tu_cau }}_{{ dap_an.id }}" value="dung" class="hidden peer" />
                        <span class="w-6 h-6 flex-shrink-0 flex items-center justify-center rounded-full border peer-checked:bg-blue-700 peer-checked:border-blue-700 bg-gray-300 border-gray-300"></span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" id="radio{{ noi_dung_de.thu_tu_cau }}-{{ dap_an.id }}-sai" name="answer_{{ noi_dung_de.thu_tu_cau }}_{{ dap_an.id }}" value="sai" class="hidden peer" />
                        <span class="w-6 h-6 flex-shrink-0 flex items-center justify-center rounded-full border peer-checked:bg-blue-700 peer-checked:border-blue-700 bg-gray-300 border-gray-300"></span>
                    </label>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% elif noi_dung_de.cau_hoi.loai_cau_hoi == 'TL' %}
<div id="question-{{ noi_dung_de.thu_tu_cau }}" data-tab="{{ noi_dung_de.thu_tu_cau }}" class="question-container max-w-full flex-1 mb-4">
    <div class="flex flex-col items-start">
        <!-- Tiêu đề -->
        <h2 class="font-bold text-xl">{{ noi_dung_de.cau_hoi.tieu_de }}</h2>
    
        <div class="relative pl-12 py-2">
            <!-- Số thứ tự câu hỏi -->
            <div class="absolute top-1/2 left-0 -translate-y-1/2 bg-gray-200 rounded-full w-10 h-10 flex items-center justify-center">
                <span class="font-bold text-gray-700">{{ noi_dung_de.thu_tu_cau }}</span>
            </div>
            
            <!-- Nội dung câu hỏi và ô nhập liệu -->
            <div class="flex items-center">
                <div class="text-lg font-medium mr-2 latex-content">
                    {{ noi_dung_de.cau_hoi.noi_dung|safe }}
                </div>
                <input 
                    type="text"
                    id="inputTextArea{{ noi_dung_de.thu_tu_cau }}" 
                    name="answer_{{ noi_dung_de.thu_tu_cau }}" 
                    class="w-32 h-10 border-gray-300 focus:ring-blue-500 focus:border-blue-500 rounded-md transition-all p-2"
                >
            </div>
        </div>
    </div>
    {% if noi_dung_de.cau_hoi.anh %}
    <div class="mt-4">
        <img src="{{ noi_dung_de.cau_hoi.anh.url }}" alt="Image" class="max-w-full h-auto" />
    </div>
    {% endif %}
</div>
{% endif %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.latex-content').forEach(function(element) {
      element.innerHTML = element.innerHTML.replace(/\${2}(.*?)\${2}/g, '\\($1\\)');
    });
    MathJax.typeset();
  });
</script>